
<!DOCTYPE html>
<html>
<head>
<style type="text/css">
.inline {
  background-color: #f7f7f7;
  border:solid 1px #B0B0B0;
}
.error {
	font-weight: bold;
	color: #FF0000;
}
.warning {
	font-weight: bold;
}
.message {
	font-style: italic;
}
.source, .output, .warning, .error, .message {
	padding: 0 1em;
  border:solid 1px #F7F7F7;
}
.source {
  background-color: #f5f5f5;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.center {
  text-align: center;
}
.hl.num {
  color: #AF0F91;
}
.hl.str {
  color: #317ECC;
}
.hl.com {
  color: #AD95AF;
  font-style: italic;
}
.hl.opt {
  color: #000000;
}
.hl.std {
  color: #585858;
}
.hl.kwa {
  color: #295F94;
  font-weight: bold;
}
.hl.kwb {
  color: #B05A65;
}
.hl.kwc {
  color: #55aa55;
}
.hl.kwd {
  color: #BC5A65;
  font-weight: bold;
}
</style>
  <script src="https://yihui.name/media/js/center-images.js"></script>
  <title>A Report Generated by knitr</title>
</head>
<body>

  <p>This report is automatically generated with the R
    package <a href="https://yihui.name/knitr/"><strong>knitr</strong></a>
    (version <code class="knitr inline">1.29</code>)
    .</p>

<div class="chunk" id="auto-report"><div class="rcode"><div class="source"><pre class="knitr r"><span class="hl com">## The required packages</span>

<span class="hl kwd">library</span><span class="hl std">(lattice)</span>
<span class="hl kwd">library</span><span class="hl std">(caret)</span>
<span class="hl kwd">library</span><span class="hl std">(ggplot2)</span>
<span class="hl kwd">library</span><span class="hl std">(randomForest)</span>
<span class="hl kwd">library</span><span class="hl std">(rpart)</span>
<span class="hl kwd">library</span><span class="hl std">(rattle)</span>
<span class="hl kwd">library</span><span class="hl std">(RColorBrewer)</span>

<span class="hl kwd">set.seed</span><span class="hl std">(</span><span class="hl num">1234</span><span class="hl std">)</span>

<span class="hl com">## Downloading the files </span>

<span class="hl std">trainingUrl</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;</span>
<span class="hl std">testingUrl</span> <span class="hl kwb">&lt;-</span> <span class="hl str">&quot;https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;</span>

<span class="hl kwa">if</span> <span class="hl std">(</span><span class="hl opt">!</span><span class="hl kwd">file.exists</span><span class="hl std">(</span><span class="hl str">'./pml-testing.csv'</span><span class="hl std">)</span> <span class="hl opt">&amp; !</span><span class="hl kwd">file.exists</span><span class="hl std">(</span><span class="hl str">'./pml-training.csv'</span><span class="hl std">)){</span>
  <span class="hl kwd">download.file</span><span class="hl std">(testingUrl,</span><span class="hl str">'./pml-testing.csv'</span><span class="hl std">,</span> <span class="hl kwc">mode</span> <span class="hl std">=</span> <span class="hl str">'wb'</span><span class="hl std">)</span>
  <span class="hl kwd">download.file</span><span class="hl std">(trainingUrl,</span><span class="hl str">'./pml-training.csv'</span><span class="hl std">,</span> <span class="hl kwc">mode</span> <span class="hl std">=</span> <span class="hl str">'wb'</span><span class="hl std">)</span>
<span class="hl std">}</span>

<span class="hl com">## Loading the files</span>

<span class="hl std">train</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;pml-training.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">na.strings</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;NA&quot;</span><span class="hl std">,</span><span class="hl str">&quot;#DIV/0!&quot;</span><span class="hl std">,</span><span class="hl str">&quot;&quot;</span><span class="hl std">))</span>
<span class="hl std">test</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">read.csv</span><span class="hl std">(</span><span class="hl str">&quot;pml-testing.csv&quot;</span><span class="hl std">,</span> <span class="hl kwc">na.strings</span> <span class="hl std">=</span> <span class="hl kwd">c</span><span class="hl std">(</span><span class="hl str">&quot;NA&quot;</span><span class="hl std">,</span><span class="hl str">&quot;#DIV/0!&quot;</span><span class="hl std">,</span><span class="hl str">&quot;&quot;</span><span class="hl std">))</span>

<span class="hl com">## Deleting columns with missing values only</span>

<span class="hl std">train</span><span class="hl kwb">&lt;-</span><span class="hl std">train[,</span><span class="hl kwd">colSums</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(train))</span> <span class="hl opt">==</span> <span class="hl num">0</span><span class="hl std">]</span>
<span class="hl std">test</span><span class="hl kwb">&lt;-</span><span class="hl std">test[,</span><span class="hl kwd">colSums</span><span class="hl std">(</span><span class="hl kwd">is.na</span><span class="hl std">(test))</span> <span class="hl opt">==</span> <span class="hl num">0</span><span class="hl std">]</span>

<span class="hl com">## Removing non-relevant variables</span>

<span class="hl std">train</span> <span class="hl kwb">&lt;-</span> <span class="hl std">train[,</span><span class="hl opt">-</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">7</span><span class="hl std">)]</span>
<span class="hl std">test</span> <span class="hl kwb">&lt;-</span><span class="hl std">test[,</span><span class="hl opt">-</span><span class="hl kwd">c</span><span class="hl std">(</span><span class="hl num">1</span><span class="hl opt">:</span><span class="hl num">7</span><span class="hl std">)]</span>


<span class="hl com">## Partitioning the training set </span>

<span class="hl std">inTrain</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">createDataPartition</span><span class="hl std">(</span><span class="hl kwc">y</span><span class="hl std">=train</span><span class="hl opt">$</span><span class="hl std">classe,</span> <span class="hl kwc">p</span> <span class="hl std">=</span> <span class="hl num">0.6</span><span class="hl std">,</span> <span class="hl kwc">list</span> <span class="hl std">=</span> <span class="hl num">FALSE</span><span class="hl std">)</span>
<span class="hl std">trainTrain</span> <span class="hl kwb">&lt;-</span> <span class="hl std">train [inTrain, ]</span>
<span class="hl std">trainTest</span> <span class="hl kwb">&lt;-</span> <span class="hl std">train[</span><span class="hl opt">-</span><span class="hl std">inTrain, ]</span>

<span class="hl com">## Visualizing the training set</span>
<span class="hl std">classe</span> <span class="hl kwb">&lt;-</span> <span class="hl std">trainTrain</span><span class="hl opt">$</span><span class="hl std">classe</span>
<span class="hl kwd">ggplot</span><span class="hl std">(</span><span class="hl kwd">data.frame</span><span class="hl std">(classe),</span> <span class="hl kwd">aes</span> <span class="hl std">(</span><span class="hl kwc">x</span> <span class="hl std">= classe))</span> <span class="hl opt">+</span> <span class="hl kwd">geom_bar</span><span class="hl std">()</span>
</pre></div>
</div><div class="rimage center"><img src="figure/predictionPro-Rhtmlauto-report-1.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl com">## Decision Tree model with its plot and prediction</span>

<span class="hl std">modFit1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">rpart</span><span class="hl std">(classe</span> <span class="hl opt">~</span> <span class="hl std">.,</span> <span class="hl kwc">data</span><span class="hl std">=trainTrain,</span> <span class="hl kwc">method</span> <span class="hl std">=</span> <span class="hl str">&quot;class&quot;</span><span class="hl std">)</span>
<span class="hl kwd">fancyRpartPlot</span><span class="hl std">(modFit1)</span>
</pre></div>
<div class="warning"><pre class="knitr r">## Warning: labs do not fit even at cex 0.15, there may be some overplotting
</pre></div>
</div><div class="rimage center"><img src="figure/predictionPro-Rhtmlauto-report-2.png" title="plot of chunk auto-report" alt="plot of chunk auto-report" class="plot" /></div><div class="rcode">
<div class="source"><pre class="knitr r"><span class="hl std">prediction1</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modFit1, trainTest,</span> <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;class&quot;</span><span class="hl std">)</span>

<span class="hl com">## Checking if the predictions and classe variables are same level factors</span>

<span class="hl kwd">str</span><span class="hl std">(prediction1)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  Factor w/ 5 levels &quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;names&quot;)= chr [1:7846] &quot;1&quot; &quot;2&quot; &quot;6&quot; &quot;8&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl kwd">str</span><span class="hl std">(trainTest</span><span class="hl opt">$</span><span class="hl std">classe)</span>
</pre></div>
<div class="output"><pre class="knitr r">##  chr [1:7846] &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; &quot;A&quot; ...
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Turning the classe variable into appropriate factor</span>
<span class="hl std">factoredClasse</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">factor</span><span class="hl std">(trainTest</span><span class="hl opt">$</span><span class="hl std">classe,</span> <span class="hl kwc">levels</span> <span class="hl std">=</span> <span class="hl kwd">c</span> <span class="hl std">(</span><span class="hl str">&quot;A&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;B&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;C&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;D&quot;</span><span class="hl std">,</span> <span class="hl str">&quot;E&quot;</span><span class="hl std">))</span>

<span class="hl com">## Testing the prediction</span>
<span class="hl kwd">confusionMatrix</span><span class="hl std">(prediction1, factoredClasse)</span>
</pre></div>
<div class="output"><pre class="knitr r">## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1930  231   47   81   53
##          B   82  866   67  103  121
##          C   59  189 1062  173  134
##          D   94  118   85  821   70
##          E   67  114  107  108 1064
## 
## Overall Statistics
##                                          
##                Accuracy : 0.732          
##                  95% CI : (0.722, 0.7417)
##     No Information Rate : 0.2845         
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
##                                          
##                   Kappa : 0.6605         
##                                          
##  Mcnemar's Test P-Value : &lt; 2.2e-16      
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.8647   0.5705   0.7763   0.6384   0.7379
## Specificity            0.9266   0.9411   0.9143   0.9441   0.9382
## Pos Pred Value         0.8241   0.6990   0.6568   0.6911   0.7288
## Neg Pred Value         0.9451   0.9013   0.9509   0.9302   0.9408
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2460   0.1104   0.1354   0.1046   0.1356
## Detection Prevalence   0.2985   0.1579   0.2061   0.1514   0.1861
## Balanced Accuracy      0.8957   0.7558   0.8453   0.7912   0.8380
</pre></div>
<div class="source"><pre class="knitr r"><span class="hl com">## Random forest model with its prediction </span>

<span class="hl std">modFit2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">randomForest</span><span class="hl std">(</span><span class="hl kwd">as.factor</span><span class="hl std">(classe)</span> <span class="hl opt">~</span><span class="hl std">. ,</span> <span class="hl kwc">data</span> <span class="hl std">= trainTrain)</span>
<span class="hl std">prediction2</span> <span class="hl kwb">&lt;-</span> <span class="hl kwd">predict</span><span class="hl std">(modFit2, trainTest,</span> <span class="hl kwc">type</span> <span class="hl std">=</span> <span class="hl str">&quot;class&quot;</span><span class="hl std">)</span>

<span class="hl com">## Testing the result </span>

<span class="hl kwd">confusionMatrix</span><span class="hl std">(prediction2, factoredClasse)</span>
</pre></div>
<div class="output"><pre class="knitr r">## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 2230   12    0    0    0
##          B    1 1506    5    0    0
##          C    0    0 1357   10    3
##          D    1    0    6 1274    5
##          E    0    0    0    2 1434
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9943          
##                  95% CI : (0.9923, 0.9958)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9927          
##                                           
##  Mcnemar's Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            0.9991   0.9921   0.9920   0.9907   0.9945
## Specificity            0.9979   0.9991   0.9980   0.9982   0.9997
## Pos Pred Value         0.9946   0.9960   0.9905   0.9907   0.9986
## Neg Pred Value         0.9996   0.9981   0.9983   0.9982   0.9988
## Prevalence             0.2845   0.1935   0.1744   0.1639   0.1838
## Detection Rate         0.2842   0.1919   0.1730   0.1624   0.1828
## Detection Prevalence   0.2858   0.1927   0.1746   0.1639   0.1830
## Balanced Accuracy      0.9985   0.9956   0.9950   0.9944   0.9971
</pre></div>
</div></div>

  <p>The R session information (including the OS info, R version and all
    packages used):</p>

<div class="chunk" id="session-info"><div class="rcode"><div class="source"><pre class="knitr r">    <span class="hl kwd">sessionInfo</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## R version 4.0.2 (2020-06-22)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 19041)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=Korean_Korea.949  LC_CTYPE=Korean_Korea.949   
## [3] LC_MONETARY=Korean_Korea.949 LC_NUMERIC=C                
## [5] LC_TIME=Korean_Korea.949    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] Hmisc_4.4-1         Formula_1.2-3       survival_3.2-3     
##  [4] RColorBrewer_1.1-2  rpart.plot_3.0.8    rattle_5.4.0       
##  [7] bitops_1.0-6        tibble_3.0.1        rpart_4.1-15       
## [10] randomForest_4.6-14 caret_6.0-86        ggplot2_3.3.2      
## [13] lattice_0.20-41    
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.4.6         lubridate_1.7.9      png_0.1-7           
##  [4] class_7.3-17         digest_0.6.25        ipred_0.9-9         
##  [7] foreach_1.5.0        R6_2.4.1             plyr_1.8.6          
## [10] backports_1.1.7      stats4_4.0.2         evaluate_0.14       
## [13] e1071_1.7-3          highr_0.8            pillar_1.4.4        
## [16] rlang_0.4.6          rstudioapi_0.11      data.table_1.13.0   
## [19] Matrix_1.2-18        checkmate_2.0.0      labeling_0.3        
## [22] splines_4.0.2        gower_0.2.2          stringr_1.4.0       
## [25] foreign_0.8-80       htmlwidgets_1.5.1    munsell_0.5.0       
## [28] xfun_0.15            compiler_4.0.2       pkgconfig_2.0.3     
## [31] base64enc_0.1-3      htmltools_0.5.0      nnet_7.3-14         
## [34] tidyselect_1.1.0     gridExtra_2.3        htmlTable_2.0.1     
## [37] prodlim_2019.11.13   codetools_0.2-16     crayon_1.3.4        
## [40] dplyr_1.0.0          withr_2.2.0          MASS_7.3-51.6       
## [43] recipes_0.1.13       ModelMetrics_1.2.2.2 grid_4.0.2          
## [46] nlme_3.1-148         gtable_0.3.0         lifecycle_0.2.0     
## [49] magrittr_1.5         pROC_1.16.2          scales_1.1.1        
## [52] stringi_1.4.6        farver_2.0.3         reshape2_1.4.4      
## [55] latticeExtra_0.6-29  timeDate_3043.102    ellipsis_0.3.1      
## [58] generics_0.0.2       vctrs_0.3.1          lava_1.6.7          
## [61] iterators_1.0.12     tools_4.0.2          glue_1.4.1          
## [64] purrr_0.3.4          jpeg_0.1-8.1         colorspace_1.4-1    
## [67] cluster_2.1.0        knitr_1.29
</pre></div>
<div class="source"><pre class="knitr r">    <span class="hl kwd">Sys.time</span><span class="hl std">()</span>
</pre></div>
<div class="output"><pre class="knitr r">## [1] &quot;2020-08-30 19:19:44 KST&quot;
</pre></div>
</div></div>


</body>
</html>
